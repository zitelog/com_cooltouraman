function showError(){var e,t,a;for(e=Joomla.JText._("JLIB_FORM_FIELD_INVALID"),t=jQuery("label.invalid"),a={},a.error=[],i=0;i<t.length;i++){var r=jQuery(t[i]).text();"undefined"!==r&&(a.error[i]=e+r.replace("*",""))}Joomla.renderMessages(a)}function jSelectTeacher_jform_teacher_name(e,t,a){return jQuery("#"+a+"-lbl").html(t),jQuery("#"+a+"-substitute").val(t),jModalClose()}function jSelectStudent_jform_student_name(e,t){if(!document.getElementById("studentId_"+e)){jQuery('div[id^="page-"]');jQuery('div[id^="page-"]').each(function(){var a=jQuery(this).find("tr.row0"),r=jQuery(this).find(".table"),n=parseInt(jQuery(this).find(".table >tbody >tr").length),s=a.clone();s.removeClass("row0").addClass("row"+n),s.attr("id","studentId_"+e),s.find("input").each(function(){var a=jQuery(this).attr("name").replace(/0/,n);jQuery(this).attr("name",a),a.match(/name\b/)&&jQuery(this).val(t),a.match(/id\b/)&&jQuery(this).val(e)});var i=s.find("td:first").html();i=i.replace(/id=##/,"id="+e),i=i.replace(/##/,t),s.find("td:first").html(i),s.find("td#trashBnt").each(function(){i=jQuery(this).html(),i=i.replace(/##/g,e),jQuery(this).html(i)}),s.removeAttr("style"),r.append(s)}),addAccountingRow(e,t)}return jModalClose()}function deleteRow(e,t){var a=jQuery(e).closest("tr"),r=a.attr("class").match(/^row([0-9])$\b/);r&&(jQuery("."+r[0]).remove(),jQuery("#accounting_studentId_"+t).remove())}function addAccountingRow(e,t){var a=jQuery("#accounting_table");if(a.length>0){var r=jQuery("#jform_prices_price_base").val(),n=(parseInt(a.find(">tbody >tr").length),jQuery("#accounting_studentId_29061793")),s=n.clone(),i=s.html();i=i.replace(/29061793/g,e),i=i.replace(/%name%/g,t.trim()),i=i.replace(/%price%/g,r),i=i.replace(/%balance%/g,r),s.html(i),s.find(".student_balance"+e).css("color","red"),s.attr("id","accounting_studentId_"+e),s.removeAttr("style"),a.append(s);var o='jQuery(document).ready(function($){Calendar.setup({inputField:"jform_accounting_students_student'+e+'_registration",ifFormat: "%Y-%m-%d",button:"jform_accounting_students_student'+e+'_registration_img",align: "Tl",singleClick: true,firstDay: 1});Calendar.setup({inputField:"jform_accounting_students_student'+e+'_earlyend",ifFormat: "%Y-%m-%d",button:"jform_accounting_students_student'+e+'_earlyend_img",align: "Tl",singleClick: true,firstDay: 1});});';jQuery("<script>").attr("type","text/javascript").text(o).appendTo("head")}}function calcBalanceValue(e){var t=parseInt(jQuery("#jform_accounting_students_student"+e+"_price").val()),a=parseInt(jQuery("#jform_accounting_students_student"+e+"_discount").val()),r=0;jQuery(".payment_amount"+e).each(function(){r+=parseInt(jQuery(this).val())}),a>0&&(t=a),t-=r,jQuery(".student_balance"+e).html(t),jQuery('input[name="jform[accounting][students][student'+e+'][balance]"]').val(t),0===t&&jQuery(".student_balance"+e).css("color","green")}function addPaymentRow(e){var t=jQuery("#accounting_payment_table_student_id_"+e),a=t.find("tr").last(),r="row0",n="payment_"+e+"_0",s=0,i="jform_accounting_students_student"+e+"_payments_payment0_date",o="jform_accounting_students_student"+e+"_payments_payment0_amount",d="";if(a.length>0){var u=new RegExp("payment_"+e+"_(\\d{1})");r=a.attr("class").match(/^row(\d{1})$\b/),r.length>0&&(r=parseInt(r[1]),r=1===r?"row0":"row1"),n=a.attr("id").match(u),n.length>0&&(s=parseInt(n[1])+1,n="payment_"+e+"_"+s,i="jform_accounting_students_student"+e+"_payments_payment"+s+"_date",o="jform_accounting_students_student"+e+"_payments_payment"+s+"_amount")}d+='<tr class="'+r+'" id="'+n+'">\n\r',d+="<td>\n\r",d+='<div class="input-append">\n\r',d+='<input type="text" name="jform[accounting][students][student'+e+"][payments][payment"+s+'][date]" id="'+i+'" class="input-small" data-original-title>\n\r',d+='<button type="button" class="btn" id="'+i+'_img"><span class="icon-calendar"></span></button>\n\r',d+="</div>\n\r",d+="</td>\n\r",d+="<td>\n\r",d+='<input type="text" name="jform[accounting][students][student'+e+"][payments][payment"+s+'][amount]" id="'+o+'" onchange="calcBalanceValue('+e+')" class="input-micro payment_amount'+e+'">\n\r',d+="</td>\n\r",d+='<td width="1%" align="center">\n\r',d+='<a class="btn btn-micro" href="javascript:void(0);" onclick="return deletePaymentRow(this, '+e+');"><span class="icon-trash"></span></a>\n\r',d+="</td>\n\r",d+="</tr>\n\r",t.append(d);var l='jQuery(document).ready(function($){Calendar.setup({inputField:"'+i+'",ifFormat: "%Y-%m-%d",button:"'+i+'_img",align: "Tl",singleClick: true,firstDay: 1});});';jQuery("<script>").attr("type","text/javascript").text(l).appendTo("head")}function deletePaymentRow(e,t){var a=jQuery(e).closest("tr");a.remove(),calcBalanceValue(t)}var Weeklyfrequency=function(e){var t=function(t,a,r,n){t===!1?(a.addClass("invalidtime").attr("aria-invalid","true"),r&&(e(r).addClass("invalidtime").attr("aria-invalid","true"),n&&e(r).attr("data-error-message",n))):(a.removeClass("invalidtime").attr("aria-invalid","false"),r&&(e(r).removeClass("invalidtime").attr("aria-invalid","false").attr("data-error-message",""),e(r).attr("data-error-message","")))},a=function(a){var r,n,s=e(a),i=0,o=0,d="",u=!0;return r=s.closest("tr"),n=r.find(".day-label"),r.find(".validate-time").each(function(a,r){var s=e(r);return t(!0,s,n,""),s.val().test("^[0-9]{2}:[0-9]{2}$")?(s.attr("id").test("^start_time_[0-9]{1}$")&&(i=new Date("1970-01-01T"+s.val()+"Z").getTime()/1e3),void(s.attr("id").test("^end_time_[0-9]{1}$")&&(o=new Date("1970-01-01T"+s.val()+"Z").getTime()/1e3))):(s.attr("id").test("^start_time_[0-9]{1}$")?d=Joomla.JText._("COM_COOLTOURAMAN_START_TIME_HOUR_AND_MINUTES_FORMAT_ERROR"):s.attr("id").test("^end_time_[0-9]{1}$")&&(d=Joomla.JText._("COM_COOLTOURAMAN_END_TIME_HOUR_AND_MINUTES_FORMAT_ERROR")),t(!1,s,n,d),u=!1,!1)}),u?i>o?(d=Joomla.JText._("COM_COOLTOURAMAN_START_TIME_GT_END_TIME_FORMAT_ERROR"),t(!1,s,n,d),!1):3600>o-i?(d=Joomla.JText._("COM_COOLTOURAMAN_LESSON_DURATION_TO_SHORT_ERROR"),t(!1,s,n,d),!1):!0:!1},r=function(r){var n,s,i,o,d=0,u=e(r),l=0,c=!0;if(s=Joomla.JText._("COM_COOLTOURAMAN_SELECT_WEEKLY_ERROR"),i=u.closest(".control-group"),"undefined"!==i&&(o=i.find("label")),u.find(".validate-day").each(function(t,r){"checkbox"===e(r).attr("type")&&e(r).is(":checked")&&(l++,a(r)!==!1&&d++)}),t(!0,u,o,""),0===l&&(t(!1,u,o,s),c=!1),l!==d&&(c=!1),!c){var s,m,y;for(s=Joomla.JText._("JLIB_FORM_FIELD_INVALID"),m=e(l>0?"td.invalidtime":"label.invalidtime"),y={},y.error=[],n=0;n<m.length;n++){var _=e(m[n]).text(),f=e(m[n]).attr("data-error-message");"undefined"!==_&&(y.error[n]=s+_.replace("*","")+"&#160"+f)}Joomla.renderMessages(y)}return c};return{isValid:r}};jQuery&&(jQuery(document).ready(function(e){jQuery("a.indicator").click(function(){var e=0,t=0,a=null,r=jQuery(".wrapper").find('div[id^="page-"].current'),n=jQuery(this).attr("id");r.length>0&&"undefined"!=jQuery(r).attr("id")&&(e=parseInt(jQuery(r).attr("id").match(/\d+/g)[0])),e&&("next"===n&&(t=e+1),"previous"===n&&(t=e-1),a=jQuery("#page-"+t),a.length&&(jQuery(r).removeClass("current"),jQuery("#page-"+t).addClass("current"),jQuery(a).is(".page:last")?(jQuery("#next").addClass("disabled"),jQuery("#previous").removeClass("disabled")):jQuery(a).is(".page:first")&&(jQuery("#previous").addClass("disabled"),jQuery("#next").removeClass("disabled"))))}),jQuery('select[id^="jformattendanceregisterteacherattendances"]').change(function(){var e=jQuery(this).attr("id"),t=/(\d{2})-(\d{2})-(\d{4})/,a=e.match(t),r=a[1]+"-"+a[2]+"-"+a[3],n=a[1]+"_"+a[2]+"_"+a[3],s=new Date(a[3]+"/"+a[2]+"/"+a[1]),i=s.getShortMonthName().toUpperCase();e="jformattendanceregisterteacherattendances"+r;var o=e+"-lbl",d=e+"-td";if(0==parseInt(jQuery(this).val()))jQuery("#"+d).css("background-color","red"),jQuery("#"+o).html("N/A"),jQuery("#"+e+"-substitute").val("N/A"),jQuery("input:regex(id,jform_attendanceregister__students__[1-9]__attendances__"+n+")").each(function(){1==jQuery(this).val()?(jQuery('label[for="'+jQuery(this).attr("id")+'"]').removeClass("active btn-success"),jQuery(this).attr("checked",!1)):0==jQuery(this).val()&&(jQuery('label[for="'+jQuery(this).attr("id")+'"]').addClass("active btn-danger"),jQuery(this).attr("checked",!0))}),jQuery('input[name="jform[calendaroflessons]['+i+"][days]["+r+'][checked]"]').attr("checked",!1),jQuery('input[name="jform[calendaroflessons]['+i+"][days]["+r+'][holiday]"]').val(1),jQuery('input[name="jform[calendaroflessons]['+i+"][days]["+r+'][holidaytitle]"]').val(Joomla.JText._("COM_COOLTOURAMAN_TEACHER_ABSENT")),jQuery("#jformcalendaroflessonsspanday"+r).addClass("hasTooltip").css("color","red").attr("data-original-title",Joomla.JText._("COM_COOLTOURAMAN_TEACHER_ABSENT")),jQuery("#jformcalendaroflessonsspanduration"+r).css("color","red"),alert(Joomla.JText._("COM_COOLTOURAMAN_TEACHER_ABSENT_WARNING_MSG"));else if(1==parseInt(jQuery(this).val()))jQuery("#"+o).html("N/A"),jQuery("#"+d).css("background-color","white"),jQuery("#"+e+"-substitute").val("N/A"),jQuery("input:regex(id,jform_attendanceregister__students__[1-9]__attendances__"+n+")").each(function(){1==jQuery(this).val()?(jQuery('label[for="'+jQuery(this).attr("id")+'"]').addClass("active btn-success"),jQuery(this).attr("checked",!0)):0==jQuery(this).val()&&(jQuery('label[for="'+jQuery(this).attr("id")+'"]').removeClass("active btn-danger"),jQuery(this).attr("checked",!1))}),jQuery('input[name="jform[calendaroflessons]['+i+"][days]["+r+'][checked]"]').attr("checked",!0),jQuery('input[name="jform[calendaroflessons]['+i+"][days]["+r+'][holiday]"]').val(0),jQuery('input[name="jform[calendaroflessons]['+i+"][days]["+r+'][holidaytitle]"]').val(""),jQuery("#jformcalendaroflessonsspanday"+r).css("color","black"),jQuery("#jformcalendaroflessonsspanduration"+r).css("color","black");else if(2==parseInt(jQuery(this).val())){jQuery("#"+d).css("background-color","white"),jQuery("input:regex(id,jform_attendanceregister__students__[1-9]__attendances__"+n+")").each(function(){1==jQuery(this).val()?(jQuery('label[for="'+jQuery(this).attr("id")+'"]').addClass("active btn-success"),jQuery(this).attr("checked",!0)):0==jQuery(this).val()&&(jQuery('label[for="'+jQuery(this).attr("id")+'"]').removeClass("active btn-danger"),jQuery(this).attr("checked",!1))}),jQuery('input[name="jform[calendaroflessons]['+i+"][days]["+r+'][checked]"]').attr("checked",!0),jQuery('input[name="jform[calendaroflessons]['+i+"][days]["+r+'][holiday]"]').val(0),jQuery('input[name="jform[calendaroflessons]['+i+"][days]["+r+'][holidaytitle]"]').val(""),jQuery("#jformcalendaroflessonsspanday"+r).css("color","black"),jQuery("#jformcalendaroflessonsspanduration"+r).css("color","black");var u="index.php?option=com_cooltouraman&view=teachers&layout=modal&tmpl=component&field=jform_teacher_name&elemid="+e;SqueezeBox.initialize(),SqueezeBox.open(u,{handler:"iframe",size:{x:800,y:500}})}}),courseState?(jQuery("#jform_duration_in_hours").attr("disabled",!0).trigger("liszt:updated"),jQuery("#jform_start_date").attr("readonly",!0),jQuery("#jform_start_date_img").attr("disabled",!0)):(jQuery("#jform_duration_in_hours").attr("disabled",!1).trigger("liszt:updated"),jQuery("#jform_start_date").attr("readonly",!1),jQuery("#jform_start_date_img").attr("disabled",!1)),e('input[id^="day_of_week_"]').change(function(){var t=e(this).attr("id");e(this).is(":checked")?e('input[name="jform[weeklyfrequency]['+t+'][start_time]"]').focus():(e('input[name="jform[weeklyfrequency]['+t+'][start_time]"]').val(""),e('input[name="jform[weeklyfrequency]['+t+'][end_time]"]').val(""))}),"undefined"!=typeof e.fn.bootstrapWizard&&(jQuery("#rootwizard").bootstrapWizard({onNext:function(e,t,a){if(1==a){if(!document.formvalidator.validate(document.getElementById("jform_template_id")))return showError(),!1;Joomla.renderMessages("")}if(2==a){if(!document.formvalidator.validate(document.getElementById("jform_teacher_id")))return showError(),!1;Joomla.renderMessages("")}if(3==a){if(!document.formvalidator.validate(document.getElementById("jform_start_date")))return showError(),!1;Joomla.renderMessages("")}if(4==a){if(!document.weeklyfrequency.isValid(document.getElementById("weeklyfrequency-table")))return!1;Joomla.submitbutton("course.savenew")}},onTabClick:function(){return!1},onTabShow:function(e,t,a){var r=t.find("li").length,n=a+1;n==r?(jQuery(".next").removeClass("disabled"),jQuery(".next").html('<a href="#">Salva</a>')):jQuery(".next").html('<a href="#">Next</a>');var s=n/r*100;jQuery("#rootwizard .bar").css({width:s+"%"})}}),window.prettyPrint&&prettyPrint())}),document.weeklyfrequency=null,document.weeklyfrequency=new Weeklyfrequency(jQuery.noConflict())),jQuery.expr[":"].regex=function(e,t,a){var r=a[3].split(","),n=/^(data|css):/,s={method:r[0].match(n)?r[0].split(":")[0]:"attr",property:r.shift().replace(n,"")},i="ig",o=new RegExp(r.join("").replace(/^s+|s+$/g,""),i);return o.test(jQuery(e)[s.method](s.property))},Date.prototype.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.prototype.getMonthName=function(){return this.monthNames[this.getMonth()]},Date.prototype.getShortMonthName=function(){return this.getMonthName().substr(0,3)};